<root main_tree_to_execute="MainTree">
  <BehaviorTree ID="MainTree">
    <SequenceStar name="StartupWithAutoLocalization">
      <Message msg="Starting the system bringup..."/>
      <SequenceStar name="Localization">
        <Message msg="Configuring and activating map_server"/>
        <BringUpNode node_name="map_server"/>
        <Message msg="Configuring and activating amcl"/>
        <BringUpNode node_name="amcl"/>
        <Message msg="Starting auto localization"/>
        <SequenceStar>
          <globalLocalizationServiceRequest/>
          <ConditionalLoop key="is_localized" value="true">
            <Fallback>
              <Sequence>
                <IsLocalized/>
                <SetCondition key="is_localized" value="true"/>
              </Sequence>
              <SequenceStar>
                <Spin/>
                <BackUp/>
                <Spin/>
              </SequenceStar>
            </Fallback>
          </ConditionalLoop>
        </SequenceStar>
      </SequenceStar>
      <Message msg="Bring up remaining nodes"/>
      <SequenceStar name="RemainingNodes">
        <Message msg="Configuring and activating world_model"/>
        <BringUpNode node_name="world_model"/>
        <Message msg="Configuring and activating dwb_controller"/>
        <BringUpNode node_name="dwb_controller"/>
        <Message msg="Configuring and activating navfn_planner"/>
        <BringUpNode node_name="navfn_planner"/>
        <Message msg="Configuring and activating bt_navigator"/>
        <BringUpNode node_name="bt_navigator"/>
      </SequenceStar>
      <Message msg="The system is active"/>
    </SequenceStar>
  </BehaviorTree> 
</root>

